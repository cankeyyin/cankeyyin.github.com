<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns:mv="http://macVmlSchemaUri" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta name=±êÌâ content="">
<meta name=¹Ø¼ü´Ê content="">
<meta http-equiv=Content-Type content="text/html; charset=x-mac-chinesesimp">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 14">
<meta name=Originator content="Microsoft Word 14">
<link rel=File-List href="Writing%20a%20Menulet%20Extension.files/filelist.xml">
<link rel=Edit-Time-Data href="Writing%20a%20Menulet%20Extension.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Sunkay</o:Author>
  <o:LastAuthor>Sunkay</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>3</o:TotalTime>
  <o:Created>2013-04-27T11:03:00Z</o:Created>
  <o:LastSaved>2013-04-27T11:34:00Z</o:LastSaved>
  <o:Pages>5</o:Pages>
  <o:Words>2620</o:Words>
  <o:Characters>14936</o:Characters>
  <o:Lines>124</o:Lines>
  <o:Paragraphs>35</o:Paragraphs>
  <o:CharactersWithSpaces>17521</o:CharactersWithSpaces>
  <o:Version>14.0</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="Writing%20a%20Menulet%20Extension.files/themedata.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>10 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>ZH-CN</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:NoLineBreaksAfter Lang="JA">$([{¡ê£¤¡¤¡®¡°¡´¡¶¡¸¡º¡¾¡²¡¼&#12317;&#65113;&#65115;&#65117;¡ç£¨£®£Û£û&#65505;&#65509;</w:NoLineBreaksAfter>
  <w:NoLineBreaksBefore Lang="JA">!%),.:;&gt;?]}¡é¡§¡ã¡¤¡¦¡¥&#8213;¡¬¡¯¡±ÿ¡ë¡ä¡å&#8250;¡æ¡Ã¡¢¡£¡¨¡µ¡·¡¹¡»¡¿¡³¡½&#12318;¦á¦ã¦ç¦å¦ë&#65114;&#65116;&#65118;£¡£¢£¥£§£©£¬£®£º£»£¿£Ý£à£ü£ý&#65374;&#65504;</w:NoLineBreaksBefore>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="276">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Times;
	panose-1:2 0 5 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:80;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-1593833729 1073750107 16 0 415 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-1593833729 1073750107 16 0 415 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:80;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073743103 0 0 415 0;}
@font-face
	{font-family:"Lucida Grande";
	panose-1:2 11 6 0 4 5 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:-520090897 1342218751 0 0 447 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:12.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:ËÎÌå;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"±êÌâ 1×Ö·û";
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:Times;
	mso-fareast-font-family:ËÎÌå;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	font-weight:bold;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"±êÌâ 2×Ö·û";
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:Times;
	mso-fareast-font-family:ËÎÌå;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	font-weight:bold;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"±êÌâ 3×Ö·û";
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:Times;
	mso-fareast-font-family:ËÎÌå;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:purple;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Times;
	mso-fareast-font-family:ËÎÌå;
	mso-fareast-theme-font:minor-fareast;
	mso-bidi-font-family:"Times New Roman";}
pre
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"HTML  Ô¤Éè¸ñÊ½×Ö·û";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:ËÎÌå;
	mso-fareast-theme-font:minor-fareast;
	mso-bidi-font-family:Courier;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:Åú×¢¿òÎÄ±¾×Ö·û;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:9.0pt;
	font-family:"Lucida Grande";
	mso-fareast-font-family:ËÎÌå;
	mso-fareast-theme-font:minor-fareast;
	mso-font-kerning:1.0pt;}
span.1
	{mso-style-name:"±êÌâ 1×Ö·û";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"±êÌâ 1";
	mso-ansi-font-size:24.0pt;
	mso-bidi-font-size:24.0pt;
	font-family:Times;
	mso-ascii-font-family:Times;
	mso-hansi-font-family:Times;
	mso-font-kerning:18.0pt;
	font-weight:bold;}
span.2
	{mso-style-name:"±êÌâ 2×Ö·û";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"±êÌâ 2";
	mso-ansi-font-size:18.0pt;
	mso-bidi-font-size:18.0pt;
	font-family:Times;
	mso-ascii-font-family:Times;
	mso-hansi-font-family:Times;
	mso-font-kerning:0pt;
	font-weight:bold;}
span.3
	{mso-style-name:"±êÌâ 3×Ö·û";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"±êÌâ 3";
	mso-ansi-font-size:13.5pt;
	mso-bidi-font-size:13.5pt;
	font-family:Times;
	mso-ascii-font-family:Times;
	mso-hansi-font-family:Times;
	mso-font-kerning:0pt;
	font-weight:bold;}
span.HTML
	{mso-style-name:"HTML  Ô¤Éè¸ñÊ½×Ö·û";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"HTML  Ô¤Éè¸ñÊ½";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Courier;
	mso-ascii-font-family:Courier;
	mso-hansi-font-family:Courier;
	mso-bidi-font-family:Courier;
	mso-font-kerning:0pt;}
span.a
	{mso-style-name:Åú×¢¿òÎÄ±¾×Ö·û;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Åú×¢¿òÎÄ±¾;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:"Lucida Grande";
	mso-ascii-font-family:"Lucida Grande";
	mso-hansi-font-family:"Lucida Grande";
	mso-bidi-font-family:"Lucida Grande";}
span.apple-converted-space
	{mso-style-name:apple-converted-space;
	mso-style-unhide:no;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-hansi-font-family:Cambria;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:0pt;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
table.MsoNormalTable
	{mso-style-name:ÆÕÍ¨±í¸ñ;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Cambria;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:21.0pt;
text-justify-trim:punctuation'>

<div class=WordSection1>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Volume Number: 22 (2006)&#8232;Issue
Number: 2&#8232;Column Tag: Programming</span></b><span style='font-family:
Verdana;mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:16.0pt;text-align:left;
mso-line-height-alt:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:
none;text-autospace:none'><b><span style='font-size:24.0pt;font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>Writing a <span
class=SpellE>Menulet</span> Extension<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:14.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-size:18.0pt;font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>Extending an
Application or Providing a Service via a <span class=SpellE>Menulet</span><o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=GramE><i><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>by</span></i></span><i><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> Andrew Turner</span></i><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><b><span
style='font-size:14.0pt;font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>Introduction<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Most modern operating systems have some
constantly viewable area that displays useful icons, data, and notifications
relating to your computer and other services. Windows uses the 'task tray', the
Linux freedesktop.org specifies a 'system tray', and Mac OS X uses the <span
class=SpellE>menubar</span>. On the Mac, this <span class=SpellE>menubar</span>
is where users see the date/time, audio volume, spotlight icon, and any other
number of tools they can install to display information.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The <span class=SpellE>menubar</span>
icons and tools are frequently called '<span class=SpellE>menulets</span>', or
status items. <span class=SpellE>Menulets</span> can be an application unto
themselves, such as <span class=SpellE>MenuMeters</span> (<a
href="http://www.ragingmenace.com/%20software/menumeters/"><span
style='color:#164C93'>http://www.ragingmenace.com/ software/menumeters/</span></a>),
which displays the current CPU, memory, or network usage as graphs and blinking
lights. A <span class=SpellE>menulet</span> can also extend a larger
application such as <span class=SpellE>DesktopManager's</span> (<a
href="http://desktopmanager.berlios.de/"><span style='color:#164C93'>http://desktopmanager.berlios.de/</span></a>)
<span class=SpellE>menulet</span> that allows a user another means to switch
between multiple virtual desktops and can display the current viewable desktop.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>&#8232;</span><span style='mso-fareast-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'> </span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt;mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x56fe__x7247__x0020_21" o:spid="_x0000_i1029"
 type="#_x0000_t75" alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure1_small.jpg"
 style='width:400pt;height:16pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Writing%20a%20Menulet%20Extension.files/image001.jpg"
  o:title="//www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure1_small.jpg"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=402 height=18
src="Writing%20a%20Menulet%20Extension.files/image002.png"
alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure1_small.jpg"
v:shapes="_x56fe__x7247__x0020_21"><![endif]></span><span style='font-size:
9.0pt;font-family:Verdana;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";color:#666666;mso-font-kerning:0pt'><br>
<b><span style='background:#B6BCC2'>Figure 1: Example <span class=SpellE>Menubar</span>
with <span class=SpellE>Menulets</span>.</span></b></span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='margin-bottom:12.0pt;text-align:center;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Figure 1 shows an example menubar
with the menulets (from left to right): DesktopManager, Salling Clicker,
Applescript Menu, MissingSync, MenuMeters, Date/Time, Audio, and Spotlight.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>There are two major 'flavors' of <span
class=SpellE>menulets</span>: the standard and publicly documented <span
class=SpellE>NSStatusItem</span> and the private and undocumented <span
class=SpellE>NSMenuExtra</span>. <span class=SpellE>NSStatusItems</span> are
fully capable of doing most anything a <span class=SpellE>menulet</span> can
do. The one major benefit of an <span class=SpellE>NSMenuExtra</span> is the
ability to mouse-drag <span class=GramE>reorder</span> the <span class=SpellE>menulet</span>
with regards to the other system <span class=SpellE>menulets</span>, whereas <span
class=SpellE>NSStatusItems</span> are placed further along the left-side of the
<span class=SpellE>menulets</span> area of the <span class=SpellE>menubar</span>.
Because the <span class=SpellE>NSMenuExtra</span> API is undocumented, and
subject to change by Apple whenever deemed necessary, it is best to avoid using
the API in your applications.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The rest of this article will lead
you through developing your own <span class=SpellE>NSStatusItem</span> <span
class=SpellE>menulet</span> including displaying text or an icon in the view,
making a drop-menu and setting up automatic updating.<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><b><span
style='font-size:14.0pt;font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>Creating the <span class=SpellE>Menulet</span><o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The first thing to do is create a new
<span class=SpellE>XCode</span> project for building this tutorial.
Alternatively, you could add these files and resources to an already existing
application. <span class=SpellE>Menulets</span> must belong to an application
since the status bar will not retain and update your <span class=SpellE>menulet</span>
for you. Therefore, for purposes of illustration and testing we will be
creating a new, stand-alone application for controlling our <span class=SpellE>menulet</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The example <span class=SpellE>menulet</span>
will display the user's external IP address in the menu bar. <span class=GramE>The
external IP address is obtained by querying a remote server and then setting
the text in the <span class=SpellE>menubar</span> to</span> the external IP
address.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>In <span class=SpellE>XCode</span>
select New Project... and choose to create a Cocoa Application. After the new
project is created, right click on the Classes folder and choose Add &gt; New
File... You will be adding <span class=GramE>an 'Objective</span>-C class', and
name it &quot;<span class=SpellE>IPMenulet.m</span>&quot;. Make sure to leave
'Also create <span class=SpellE>IPMenulet.h</span>' checked.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The application will need to hold a
reference to the <span class=SpellE>NSStatusItem</span>, as well as initialize
the <span class=SpellE>menulet</span>, add it to the system status bar, and update
data in the <span class=SpellE>menulet</span>. Add the following code to the <span
class=SpellE>IPMenulet.h</span> and <span class=SpellE>IPMenulet.m</span> files
you created in your project.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.h</span></b></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>@<span class=GramE>interface</span> <span class=SpellE>IPMenulet</span>
: <span class=SpellE>NSObject</span> {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>NSStatusItem</span> *<span class=SpellE>statusItem</span>;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>-(<span class=SpellE><span class=GramE>IBAction</span></span><span
class=GramE>)<span class=SpellE>updateIPAddress</span></span>:(id)sender;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.m</span></b></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>-(<span class=GramE>void</span>)<span class=SpellE>dealloc</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;
</span>[<span class=SpellE><span class=GramE>statusItem</span></span> release];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[<span
class=GramE>super</span> <span class=SpellE>dealloc</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>- (<span class=GramE>void</span>)<span class=SpellE>awakeFromNib</span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>statusItem</span></span> = [[[<span
class=SpellE>NSStatusBar</span> <span class=SpellE>systemStatusBar</span>] <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>statusItemWithLength:NSVariableStatusItemLength</span></span>]<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>retain</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setHighlightMode:YES</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setTitle</span>:[<span
class=SpellE>NSString</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=SpellE><span class=GramE>stringWithString</span></span>:@&quot;0.0.0.0&quot;]];
<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setEnabled:YES</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setToolTip</span>:@&quot;<span
class=SpellE>IPMenulet</span>&quot;];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setAction</span>:@selector(<span
class=SpellE>updateIPAddress</span>:)];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setTarget:self</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The code above creates and attaches
a new <span class=SpellE>NSStatusItem</span> of variable length to the system
status bar. Since the status item is variable length, the area will grow and
shrink depending on the content of the status item's title or icon.
Alternatively, you could set the length via the <span class=SpellE>statusItemWithLength</span>:
method to <span class=SpellE>NSSquareStatusItemLength</span>, which would fix
the width of the status item to the height of the status bar (currently always
22 pixels high).<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The parameter <span class=SpellE>highlightMode</span>
specifies if a box is drawn around the <span class=SpellE>menulet</span> when
clicked, and enabled determines if the <span class=SpellE>menulet</span> is
grayed out or darkened. Since we don't yet know our IP address, we will set the
initial display to 0.0.0.0, and the tooltip is what is displayed when a user
hovers their mouse over the <span class=SpellE>menulet</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>At the end of the initialization
code there are the <span class=SpellE>setAction</span>: and <span class=SpellE>setTarget</span>:
functions. Similar to other applications, these functions set the functions
that should be called when a user clicks on the <span class=SpellE>menulet</span>.
In this example, we will be updating the IP address whenever the user clicks on
the <span class=SpellE>menubar</span>. It is also possible to set the
double-click action if desired.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>We now need to implement the <span
class=SpellE>updateIPAddress</span>: method.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.m</span></b></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>-(<span class=SpellE><span class=GramE>IBAction</span></span><span
class=GramE>)<span class=SpellE>updateIPAddress</span></span>:(id)sender<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span
class=SpellE>NSString</span> *<span class=SpellE>ipAddr</span> = [<span
class=SpellE>NSString</span> <span class=SpellE>stringWithContentsOfURL</span>:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>[NSURL <span class=SpellE>URLWithString</span>:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>@&quot;http://highearthorbit.com/service/myip.php&quot;]];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span
class=GramE>if</span>(<span class=SpellE>ipAddr</span> != NULL)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setTitle</span>:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>[<span class=SpellE>NSString</span> <span class=SpellE>stringWithString<span
class=GramE>:ipAddr</span></span>]]; <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The <span class=SpellE>updateIPAddress</span>:
function gets the IP address as a string from an external server query and then
sets the title of the <span class=SpellE>NSStatusItem</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Building the NIB Interface</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>We now have all of the code that we
<span class=GramE>need .</span> However, when the application starts, it needs
to know to create the <span class=SpellE>menulet</span>. Therefore, we will
create an instantiation of the <span class=SpellE>menulet</span> in the NIB
file that is loaded. This will allow us to later add more code and hooks to our
<span class=SpellE>menulet</span> for controlling menu items.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>To create the <span class=SpellE>menulet</span>
double-click the <span class=SpellE>MainMenu.nib</span> in the Resources folder
of the project. After it loads, click the &quot;Classes&quot; tab, then choose
&quot;Classes&quot; in the <span class=SpellE>menubar</span>, &quot;Read
Files...<span class=GramE>&quot;,</span> navigate to <span class=SpellE>IPMenulet.h</span>
and &quot;Parse&quot;.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>&#8232;</span><span style='mso-fareast-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'> </span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt;mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="_x56fe__x7247__x0020_19" o:spid="_x0000_i1028" type="#_x0000_t75" alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure2_small.jpg"
 style='width:300pt;height:272pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Writing%20a%20Menulet%20Extension.files/image003.jpg"
  o:title="//www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure2_small.jpg"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=302 height=274
src="Writing%20a%20Menulet%20Extension.files/image004.jpg"
alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure2_small.jpg"
v:shapes="_x56fe__x7247__x0020_19"><![endif]></span><span style='font-size:
9.0pt;font-family:Verdana;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";color:#666666;mso-font-kerning:0pt'><br>
<b><span style='background:#B6BCC2'>Figure 2: Parsing <span class=SpellE>IPMenulet.h</span>
into Interface Builder allows it to be instantiated as part of the application.</span></b></span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='margin-bottom:12.0pt;text-align:center;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>This parsing loads the <span
class=SpellE>IPMenulet</span> interface into Interface Builder. We still need
an instance of the class to use in our application. Right-click &quot;<span
class=SpellE>IPMenulet</span>&quot; in the pane view and click
&quot;Instantiate <span class=SpellE>IPMenulet</span>&quot;. This will place a
blue-cube and <span class=SpellE>IPMenulet</span> instance in our Interface
Builder window.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>At this point we don't want a main
application window to pop-up at startup, so click the Window icon and delete
it. Then save the nib file, return to <span class=SpellE>XCode</span> and
choose the &quot;Build and Go&quot;.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Depending on how many <span
class=SpellE>menulets</span> you already had in your status bar you may have to
click outside of <span class=SpellE>XCode</span> since <span class=SpellE>XCode</span>
has a large number of <span class=SpellE>menubar</span> items. You should see
0.0.0.0. Click on the <span class=SpellE>menulet</span> and after a short pause
you should see an updated IP address.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Removing the Dock Icon</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>If you are making a <span
class=SpellE>menulet</span>-only application, having a dock icon seems like an
unnecessary item. It is possible to have an application 'hide' its dock icon by
specifying a new value in the &quot;<span class=SpellE>Info.plist</span>&quot;
file in your <span class=SpellE>XCode</span> project. At the end of the list,
just before, the &lt;/<span class=SpellE>dict</span>&gt;, add the following key
and value:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>&lt;<span
class=GramE>key</span>&gt;<span class=SpellE>LSUIElement</span>&lt;/key&gt;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span>&lt;<span
class=GramE>string</span>&gt;1&lt;/string&gt;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Now when your <span class=SpellE>menulet</span>
application starts up, it doesn't have a dock icon. Be careful however, as you
currently have no easy means to quit your <span class=SpellE>menulet</span>
application either. While developing, it is possible to quit the application by
pressing the &quot;Stop&quot; icon in <span class=SpellE>XCode</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><b><span
style='font-size:14.0pt;font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>Using a <span class=SpellE>Menulet</span>
Icon<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>You now have a fully functional <span
class=SpellE>menulet</span> application that takes up a lot of valuable <span
class=SpellE>menubar</span> space. For some <span class=SpellE>menulets</span>,
it may be best to use an icon that the user will click for more information, or
an icon that changes depending on the state of some application variable or
other data source.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Unicode Glyphs</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The simplest way to add an iconic
view to the <span class=SpellE>menulet</span> is by using a Unicode character
for the title. This has several benefits, such as not requiring the design,
creating, and loading of an image. Also, when a user clicks on a <span
class=SpellE>menulet</span> and it becomes highlighted, the icon should have <span
class=GramE>an 'inverse'</span> view that inverts the colors of the icon in
some way to alert the user that the <span class=SpellE>menulet</span> has been
clicked. The title of a status item, and therefore a symbolic glyph, is
automatically inverted.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Finding a good glyph (symbol) is a
bit tricky. In the end, we need the hex value for a Unicode character. Mac OS X
provides a very nice tool for looking at Unicode characters, though it is a bit
buried.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Go to System Preferences, International
and check Character Palette. After you do this you will see your current input
language flag in the <span class=SpellE>menubar</span> (look, another <span
class=SpellE>menulet</span>!). Click on the flag and choose Show Character
Palette. The character palette <span class=GramE>window pane</span> will pop-up
and sit above all of your other windows. At the top of the pane, there is View:
and a drop menu. Click on the drop menu and choose Code Tables. You can now
navigate through all of the Unicode characters. When you find a glyph that you
want to use, click on it and then get the Unicode: value next to the zoomed in
view of the character.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>&#8232;</span><span style='mso-fareast-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'> </span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt;mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="_x56fe__x7247__x0020_17" o:spid="_x0000_i1027" type="#_x0000_t75" alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure3_small.jpg"
 style='width:300pt;height:443pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Writing%20a%20Menulet%20Extension.files/image005.jpg"
  o:title="//www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure3_small.jpg"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=302 height=445
src="Writing%20a%20Menulet%20Extension.files/image006.jpg"
alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure3_small.jpg"
v:shapes="_x56fe__x7247__x0020_17"><![endif]></span><span style='font-size:
9.0pt;font-family:Verdana;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";color:#666666;mso-font-kerning:0pt'><br>
<b><span style='background:#B6BCC2'>Figure 3: The Character Palette is a very
useful tool for finding glyphs and their associated Unicode hex values.</span></b></span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='margin-bottom:12.0pt;text-align:center;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Now armed with a Unicode value,
return to the <span class=SpellE>IPMenulet.m</span> file and replace the<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>stringWithString</span></span>:@&quot;0.0.0.0&quot;]];
<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=GramE><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>with</span></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> a formatted string using one (or many) hex values the
formatter is %C. Therefore, the following code will produce the ??<span
class=GramE>symbol</span>:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>stringWithFormat</span></span>:@&quot;%C&quot;,0x2295]];
<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Image Icons</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>While using a built in glyph is
very simple, it does not offer the flexibility an icon provides. The <span
class=SpellE>NSStatusItem</span> API provides the <span class=SpellE>setImage</span>:(<span
class=SpellE>NSImage</span>*) function to set the icon. The following code
obtains a 22x22 pixel image that has been added to the project resources, which
is then stored and set to the status items image. You can use any small icon in
your project that you want. For purposes of this example, the icon is &quot;<span
class=SpellE>IPMenuIcon.tif</span>&quot;.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>First, add a pointer to an <span
class=SpellE>NSImage</span> to the data members of the <span class=SpellE>IPMenulet</span>
class.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.h</span></b></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>NSImage</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> *<span class=SpellE>menuIcon</span>;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Then we need to get the bundle, the
path, and finally the image at this path. We will store this image for future
reference if we want to show or hide the icon depending on the <span
class=SpellE>menulet's</span> state. We also set the title to an empty string
although it is allowed to have both an image and text in the status item. Make
sure to release the icon when the application quits.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.m</span></b></span><b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> (<span class=SpellE>awakeFromNib</span>:)</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>NSBundle</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> *bundle = [<span class=SpellE>NSBundle</span> <span
class=SpellE>bundleForClass</span><span class=GramE>:[</span>self class]];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>NSString</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> *path = [bundle <span class=SpellE>pathForResource</span><span
class=GramE>:@</span>&quot;<span class=SpellE>IPMenuIcon</span>&quot; <span
class=SpellE>ofType</span>:@&quot;<span class=SpellE>tif</span>&quot;];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span class=GramE><span style='font-family:Courier;mso-bidi-font-family:
Courier;color:#535353;mso-font-kerning:0pt'>menuIcon</span></span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>= [[<span class=SpellE>NSImage</span> <span class=SpellE>alloc</span>]
<span class=SpellE>initWithContentsOfFile:path</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <span
class=SpellE>stringWithString</span>:@&quot;&quot;]]; <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setImage:menuIcon</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>(<span class=SpellE><span class=GramE>dealloc</span></span>:)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>menuIcon</span></span>
release];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Test this new version. You should
see the icon in the header. When the icon is clicked, the IP address is filled
in to the right of the icon as shown in Figure 4.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>&#8232;</span><span style='mso-fareast-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'> </span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt;mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="_x56fe__x7247__x0020_15" o:spid="_x0000_i1026" type="#_x0000_t75" alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure4_small.jpg"
 style='width:200pt;height:61pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Writing%20a%20Menulet%20Extension.files/image007.jpg"
  o:title="//www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure4_small.jpg"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=202 height=63
src="Writing%20a%20Menulet%20Extension.files/image008.jpg"
alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure4_small.jpg"
v:shapes="_x56fe__x7247__x0020_15"><![endif]></span><span style='font-size:
9.0pt;font-family:Verdana;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";color:#666666;mso-font-kerning:0pt'><br>
<b><span style='background:#B6BCC2'>Figure 4: The <span class=SpellE>Menulet</span>
with both an icon and text title.</span></b></span><span style='font-size:10.0pt;
font-family:Times;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='margin-bottom:12.0pt;text-align:center;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-size:14.0pt;font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>Adding a Menu<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The <span class=SpellE>menulet</span>
has shaped up rather nicely, but is limited to a single line of information and
a single action when clicking. It is possible to extend the <span class=SpellE>menulet</span>
by adding a menu to provide more information and interaction with user such as
bringing up &quot;About&quot; boxes, &quot;Preferences...<span class=GramE>&quot;,</span>
or displaying the IP address in the menu and keeping the <span class=SpellE>menulet</span>
itself to a single icon.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>First we will modify our code to
include the pointer to the menu and a menu item we will be creating by adding
the following to the <span class=SpellE>IPMenulet</span> interface definition.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.h</span></b></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>IBOutlet</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> <span class=SpellE>NSMenu</span> *<span class=SpellE>theMenu</span>;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>NSMenuItem</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> *<span class=SpellE>ipMenuItem</span>;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Now we need to build the actual
menu. Double-click the <span class=SpellE>MainMenu.nib</span> file to bring up
Interface Builder. The first thing to do is to update Interface Builder's
knowledge of the <span class=SpellE>IPMenulet</span> class. We need to double
click the <span class=SpellE>IPMenulet</span> instantiation, right-click and
choose &quot;Read <span class=SpellE>IPMenulet.h</span>&quot;. After this is
complete, return to the &quot;Instances&quot; tab.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Choose the &quot;Cocoa-Menus&quot;
tab from the Interface Builder palette. Drag and drop the menu icon in the
lower-right corner to the <span class=SpellE>MainMenu.nib</span> panel. This
will add an NSMenu1 item to our nib file. Rename the first item &quot;External
IP&quot; and delete the second menu item.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Next we connect the menu to our
class. Control left-click and drag from the <span class=SpellE>IPMenulet</span>
instantiation to the new NSMenu1 and connect <span class=SpellE>theMenu</span>
data member of the class.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>We assigned the menu to the class,
but now the menu now needs to be assigned to <span class=SpellE>IPMenulet</span>.
Return to <span class=SpellE>XCode</span> and modify the <span class=SpellE>IPMenulet.m</span>
file to use <span class=SpellE>theMenu</span> instead of calling the <span
class=SpellE>updateIPAddress</span>: selector. We're also going to dynamically
create a menu item that is the external IP address and set it to update the IP
address when the user clicks it.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.m</span></b></span><b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> (<span class=SpellE>awakeFromNib</span>:)</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setMenu:theMenu</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span class=GramE><span style='font-family:Courier;mso-bidi-font-family:
Courier;color:#535353;mso-font-kerning:0pt'>ipMenuItem</span></span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> = [[<span class=SpellE>NSMenuItem</span> <span
class=SpellE>alloc</span>] <span class=SpellE>initWithTitle</span>:@&quot;0.0.0.0&quot;
<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>action</span>:@selector(<span class=SpellE>updateIPAddress</span>:)
<span class=SpellE>keyEquivalent</span>:@&quot;&quot;];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>ipMenuItem</span></span>
<span class=SpellE>setTarget:self</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>theMenu</span></span>
<span class=SpellE>insertItem:ipMenuItem</span> atIndex:1];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The <span class=SpellE>menulet</span>
will know to call and expand the menu on a user click. Therefore, comment out:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>//<span style="mso-spacerun:yes">&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setAction</span>:@selector(<span
class=SpellE>updateIPAddress</span>:)];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>//<span style="mso-spacerun:yes">&nbsp; </span>[<span
class=SpellE><span class=GramE>statusItem</span></span> <span class=SpellE>setTarget:self</span>];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>We also want to update the IP
address menu item with the new IP address. This is a simple change, instead of
setting the title of the <span class=SpellE><span class=GramE>statusItem</span></span><span
class=GramE>,</span> we want to change the title of the <span class=SpellE>ipMenuItem</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.m</span></b></span><b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> (<span class=SpellE>updateIPAddres</span>:)</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <span
class=SpellE>stringWithString:ipAddr</span>]];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=GramE><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>becomes</span></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'>:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>ipMenuItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <span
class=SpellE>stringWithString:ipAddr</span>]];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Click &quot;Build and Go&quot;
again to see the newest results. You will only see the icon in the <span
class=SpellE>menubar</span>. Click on this to expand down your new menu. Click
on the IP Address to have it update and change the menu item.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>&#8232;</span><span style='mso-fareast-font-family:
"Times New Roman";mso-bidi-font-family:"Times New Roman"'> </span><span
style='font-size:10.0pt;font-family:Times;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:0pt;mso-no-proof:yes'><!--[if gte vml 1]><v:shape
 id="_x56fe__x7247__x0020_13" o:spid="_x0000_i1025" type="#_x0000_t75" alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure5_small.jpg"
 style='width:200pt;height:81pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Writing%20a%20Menulet%20Extension.files/image009.jpg"
  o:title="//www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure5_small.jpg"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=202 height=83
src="Writing%20a%20Menulet%20Extension.files/image010.jpg"
alt="ËµÃ÷: http://www.mactech.com/articles/mactech/Vol.22/22.02/Menulet/figure5_small.jpg"
v:shapes="_x56fe__x7247__x0020_13"><![endif]></span><span style='font-size:
9.0pt;font-family:Verdana;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";color:#666666;mso-font-kerning:0pt'><br>
<b><span style='background:#B6BCC2'>Figure 5: The <span class=SpellE>menulet</span>
with a drop-down menu.</span></b></span><span style='font-size:10.0pt;
font-family:Times;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman";mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='margin-bottom:12.0pt;text-align:center;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><b><span
style='font-size:14.0pt;font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>Automatic Updating<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>To this point we have made a <span
class=SpellE>menulet</span> that has either an icon or text in the status bar,
and updates the IP address when the user interacts with the menu item. By
contrast, most <span class=SpellE>menulets</span> provide the user information
without requiring interaction from the user. Therefore, it is often useful to
use a timer to automatically update the <span class=SpellE>menulet</span>. This
allows the <span class=SpellE>menulet</span> to provide up to date information
without requiring constant interaction from a user.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>This example hardcodes the timer
interval to a predetermined value that seems adequate for the task, 1000
seconds. However, it would be useful for more advanced <span class=SpellE>menulets</span>
to include a preference pane or selectable menu items for setting a variable
update rate.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Add the following sections of code
to your source files:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><b><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>IPMenulet.h</span></b></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>NSTimer</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> *<span class=SpellE>updateTimer</span>;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span style='font-family:Courier;mso-bidi-font-family:Courier;
color:#535353;mso-font-kerning:0pt'>IPMenulet.m</span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> (<span class=SpellE>awakeFromNib</span>:)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
class=SpellE><span class=GramE><span style='font-family:Courier;mso-bidi-font-family:
Courier;color:#535353;mso-font-kerning:0pt'>updateTimer</span></span></span><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'> = [[<span class=SpellE>NSTimer</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=SpellE><span class=GramE>scheduledTimerWithTimeInterval</span></span>:(1000.0)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=SpellE><span class=GramE>target:self</span></span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>selector</span>:@selector(<span class=SpellE>updateIPAddress</span>:)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=SpellE><span class=GramE>userInfo:nil</span></span><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=SpellE><span class=GramE>repeats:YES</span></span>] retain];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>updateTimer</span></span>
fire];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>(<span class=SpellE><span class=GramE>dealloc</span></span>:)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>updateTimer</span></span>
release];<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>The timer is built with <span
class=GramE>1000 second</span> delay, and when it 'fires' (timer runs out), it
will call our <span class=SpellE>updateIPAddress</span>: selector. The timer
will continue firing for as long as the application remains active (repeats is
set to YES).<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Build and run the updated
application. The IP address will be updated immediately upon startup. It will
then be updated every 1000 seconds. If you want to double-check your timer,
change the timer interval to 10.0, and add<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>stringWithString</span></span>:@&quot;Updating&quot;]];
<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=GramE><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>to</span></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> the beginning of the <span class=SpellE>updateIPAddress</span>:
function. At the end of the function, add:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'>[<span class=SpellE><span class=GramE>statusItem</span></span>
<span class=SpellE>setTitle</span>:[<span class=SpellE>NSString</span> <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><span
style='font-family:Courier;mso-bidi-font-family:Courier;color:#535353;
mso-font-kerning:0pt'><span
style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>stringWithString</span></span>:@&quot;&quot;]]; <o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>These additions will cause the menu
to print &quot;Updating&quot; in the menu bar while retrieving the external IP
address.<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:18.0pt;
mso-pagination:widow-orphan;mso-layout-grid-align:none;text-autospace:none'><b><span
style='font-size:14.0pt;font-family:Verdana;mso-bidi-font-family:Verdana;
color:#535353;mso-font-kerning:0pt'>Conclusions<o:p></o:p></span></b></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>You've now successfully developed
several iterations of a Mac OS X <span class=SpellE>menulet</span>. Each
variation has different uses, depending on the desired information to be
displayed, and user interaction required. Furthermore, <span class=SpellE>menulets</span>
as described here can be made either stand-alone or as part of a larger
application. In a larger application, the <span class=SpellE>menulet's</span>
selectors and menu items would be connected to the application's code and data.
This type of interface provides users with a potentially useful resource for
quickly gleaning information from your application.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span class=SpellE><span style='font-family:Verdana;
mso-bidi-font-family:Verdana;color:#535353;mso-font-kerning:0pt'>Menulets</span></span><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> also provide an interface for drawing to an <span
class=SpellE>NSView</span>. This capability allows a developer limitless
freedom in drawing icons, graphs, <span class=SpellE>blinken</span>-lights, or
anything else in their <span class=SpellE>menulet</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>For more information on the <span
class=SpellE>NSStatusItem</span> API, check out the Apple developer
documentation:<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'><a
href="http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/ObjC_classic/Classes/NSStatusItem.html"><span
class=GramE><span style='color:#164C93'>developer.apple.com</span></span><span
style='color:#164C93'>/documentation/Cocoa/Reference/ ApplicationKit/ObjC_classic/Classes/NSStatusItem.html</span></a><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:6.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-bottom:12.0pt;text-align:left;
line-height:18.0pt;mso-pagination:widow-orphan;mso-layout-grid-align:none;
text-autospace:none'><b><span style='font-family:Verdana;mso-bidi-font-family:
Verdana;color:#535353;mso-font-kerning:0pt'>Andrew Turner</span></b><span
style='font-family:Verdana;mso-bidi-font-family:Verdana;color:#535353;
mso-font-kerning:0pt'> is a Systems Development Engineer with <span
class=SpellE>Realtime</span> Technologies, <span class=SpellE>Inc</span> (<a
href="http://www.simcreator.com/"><span style='color:#164C93'>www.simcreator.com</span></a>)
and has built robotic airships, automated his house, designed spacecraft, and
in general looks for any excuse to hack together cool technology. You can read
more about his projects at <a href="http://www.highearthorbit.com/"><span
style='color:#164C93'>www.highearthorbit.com</span></a>.<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
